# Rules configuration for risk detection
# Each rule has a pattern, category, and confidence score

rules:
  bullying:
    patterns:
      - pattern: "(?i)\\b(ugly|stupid|loser|hate you|worthless|nobody likes you)\\b"
        confidence: 0.8
        description: "Direct insults and negative labels"
      - pattern: "(?i)\\b(you're|you are) (so|really|such a) (dumb|idiot|pathetic|annoying)\\b"
        confidence: 0.75
        description: "Personal attacks"
      - pattern: "(?i)\\b(everyone|everybody) (hates|thinks you're|says you're)\\b"
        confidence: 0.7
        description: "Social exclusion attempts"
      - pattern: "(?i)\\b(kill yourself|kys|go die)\\b"
        confidence: 0.95
        description: "Severe threats"

  manipulation:
    patterns:
      - pattern: "(?i)\\b(if you (really|actually) (love|care about|care) me|if you were my (friend|true friend))\\b"
        confidence: 0.75
        description: "Conditional love/friendship"
      - pattern: "(?i)\\b(you owe me|after all i did|i did so much for you|you owe me this|after everything i (did|do) for you)\\b"
        confidence: 0.8
        description: "Obligation manipulation"
      - pattern: "(?i)\\b(no one else (will|would)|i'm the only one who)\\b"
        confidence: 0.8
        description: "Isolation attempts"
      - pattern: "(?i)\\b(you're (being|acting) (selfish|crazy|paranoid)|you're overreacting)\\b"
        confidence: 0.75
        description: "Gaslighting attempts"
      - pattern: "(?i)\\b(everyone else (does|responds|is doing)|all the (other|cool) (kids|people))\\b"
        confidence: 0.7
        description: "Comparison and belittling"
      - pattern: "(?i)\\b(this is how you treat me|this is what you do)\\b"
        confidence: 0.7
        description: "Guilt induction through framing"
      - pattern: "(?i)\\b(prove it|show me proof|send me (a )?screenshot|send me (a )?screen shot)\\b"
        confidence: 0.8
        description: "Privacy invasion demands"
      - pattern: "(?i)\\b(if you have nothing to hide|why won't you (show|prove|send))\\b"
        confidence: 0.75
        description: "Trust manipulation through proof demands"
      - pattern: "(?i)\\b(this makes me (not )?trust you|i (don't|cannot) trust you|i (can't|cannot) trust)\\b"
        confidence: 0.7
        description: "Threat of withdrawal of trust"
      - pattern: "(?i)\\b((care|trust|love) means (doing|complying|listening)|if you (care|trust|love) me you (would|will))\\b"
        confidence: 0.75
        description: "Linking care/trust to compliance"
      - pattern: "(?i)\\b(setting boundaries is (rejection|selfish|not caring)|boundaries don't matter)\\b"
        confidence: 0.8
        description: "Framing boundaries as rejection"

  pressure:
    patterns:
      - pattern: "(?i)\\b(you have to|you must|you need to|you should) (do|send|show|meet|respond|reply|answer)\\b"
        confidence: 0.7
        description: "Demanding language"
      - pattern: "(?i)\\b(right now|immediately|this instant|or else|within (\\d+ )?minutes?)\\b"
        confidence: 0.75
        description: "Urgency pressure and time ultimatums"
      - pattern: "(?i)\\b(don't be (a|such a) (baby|coward|chicken)|stop being (so|such a) (scared|afraid))\\b"
        confidence: 0.7
        description: "Peer pressure tactics"
      - pattern: "(?i)\\b(respond (faster|quicker|sooner)|reply (faster|quicker|sooner)|answer (faster|quicker)|respond to my messages (faster|quicker))\\b"
        confidence: 0.75
        description: "Communication frequency control"
      - pattern: "(?i)\\b(if you don't|if you won't|unless you) (do|respond|reply|answer|prove|show) (then|we're done|i'm done|it's over|maybe we shouldn't)\\b"
        confidence: 0.85
        description: "Ultimatums and relationship threats"
      - pattern: "(?i)\\b(we're done|i'm done|it's over|this is it|maybe we shouldn't (talk|speak)) (if|unless|i mean it)\\b"
        confidence: 0.8
        description: "Relationship ultimatums"
      - pattern: "(?i)\\b(i need to know|i need you to|i really need)\\b"
        confidence: 0.65
        description: "Pressure through need framing"
      - pattern: "(?i)\\b(promise me|you have to promise|promise you (will|won't))\\b"
        confidence: 0.75
        description: "Pressure to promise compliance"
      - pattern: "(?i)\\b(questioning (your|my) (loyalty|commitment)|are you (really|actually) (with|for) me)\\b"
        confidence: 0.7
        description: "Questioning loyalty to pressure agreement"

  secrecy:
    patterns:
      - pattern: "(?i)\\b(don't tell (anyone|your (parents|mom|dad|teacher))|keep this (secret|between us))\\b"
        confidence: 0.85
        description: "Direct secrecy demands"
      - pattern: "(?i)\\b(this is (just|only) (between|for) us|our little secret|keep (this|things) (between|just) us)\\b"
        confidence: 0.85
        description: "Exclusive secrecy"
      - pattern: "(?i)\\b(they (won't|wouldn't) understand|adults (don't|won't) get it)\\b"
        confidence: 0.7
        description: "Authority undermining"
      - pattern: "(?i)\\b(delete (this|these) (messages|texts|chats)|don't save this)\\b"
        confidence: 0.9
        description: "Evidence destruction requests"
      - pattern: "(?i)\\b(don't talk to (other people|anyone else|others) (about this|about it))\\b"
        confidence: 0.85
        description: "Isolation through secrecy demands"
      - pattern: "(?i)\\b(they (will|would) take your side|they'll (side|be) against me)\\b"
        confidence: 0.75
        description: "Discouraging outside support"
      - pattern: "(?i)\\b(don't (ask|get) (advice|help) from (others|anyone else|other people))\\b"
        confidence: 0.8
        description: "Discouraging outside advice"
      - pattern: "(?i)\\b(privacy means (keeping secrets|not telling)|keeping secrets is (privacy|private))\\b"
        confidence: 0.75
        description: "Redefining privacy as secrecy"

  guilt_shifting:
    patterns:
      - pattern: "(?i)\\b(this is (all|entirely) your fault|you made me (do|say) this)\\b"
        confidence: 0.8
        description: "Direct blame shifting"
      - pattern: "(?i)\\b(you're (making|going to make) me (feel|look) (bad|terrible|awful))\\b"
        confidence: 0.75
        description: "Emotional manipulation"
      - pattern: "(?i)\\b(i (wouldn't|would never) (have|do) (this|that) if (you|it weren't for you))\\b"
        confidence: 0.7
        description: "Conditional blame"
      - pattern: "(?i)\\b(see what you (made|forced) me to do|this is because of you)\\b"
        confidence: 0.8
        description: "Consequence blaming"
      - pattern: "(?i)\\b(you're being (selfish|unfair|unreasonable)|that's not fair)\\b"
        confidence: 0.7
        description: "Guilt induction through character attack"
      - pattern: "(?i)\\b(after everything i (did|do) for you|i (always|always) (do|did) (this|that) for you)\\b"
        confidence: 0.75
        description: "Obligation-based guilt"

  grooming:
    patterns:
      - pattern: "(?i)\\b(you're (so|really) (mature|special|different) (for your age|than others))\\b"
        confidence: 0.85
        description: "Age-inappropriate flattery"
      - pattern: "(?i)\\b(adults (don't|won't) understand (us|you) (because|since)|we're (the same|alike) (age|in age))\\b"
        confidence: 0.75
        description: "Age boundary blurring with explicit age reference"
      - pattern: "(?i)\\b(send me a (nude|naked|sexy|inappropriate) (picture|photo|pic)|show me (your|yourself))\\b"
        confidence: 0.9
        description: "Inappropriate image requests"
      - pattern: "(?i)\\b(meet me (alone|without (telling|telling anyone))|come over (when|while) (no one|nobody) (is|will be) (home|there))\\b"
        confidence: 0.9
        description: "Private meeting requests with isolation"
      - pattern: "(?i)\\b(i (love|really like) you (more than|like) (a friend|friends)|i have (feelings|feelings) for you)\\b"
        confidence: 0.8
        description: "Inappropriate romantic language"
      - pattern: "(?i)\\b(you're (so|really) (beautiful|sexy|attractive|hot) (for your age|))\\b"
        confidence: 0.85
        description: "Sexualized age-inappropriate comments"


# Rules configuration for risk detection
# Each rule has a pattern, category, and confidence score

rules:
  bullying:
    patterns:
      - pattern: "(?i)\\b(ugly|stupid|loser|hate you|worthless|nobody likes you)\\b"
        confidence: 0.8
        description: "Direct insults and negative labels"
      - pattern: "(?i)\\b(you're|you are) (so|really|such a) (dumb|idiot|pathetic|annoying)\\b"
        confidence: 0.75
        description: "Personal attacks"
      - pattern: "(?i)\\b(everyone|everybody) (hates|thinks you're|says you're)\\b"
        confidence: 0.7
        description: "Social exclusion attempts"
      - pattern: "(?i)\\b(kill yourself|kys|go die)\\b"
        confidence: 0.95
        description: "Severe threats"
      - pattern: "(?i)\\b(pathetic|dead weight|useless|burden|waste of (space|time))\\b"
        confidence: 0.85
        description: "Demeaning language and put-downs"
      - pattern: "(?i)\\b(your (best|effort|work) is (pathetic|worthless|terrible|useless))\\b"
        confidence: 0.8
        description: "Dismissive put-downs of effort"
      - pattern: "(?i)\\b(you're (the|just) (problem|issue|reason)|you (are|'re) (the|just) problem)\\b"
        confidence: 0.8
        description: "Victim-blaming statements"
      - pattern: "(?i)\\b(you (just|always) (play|act like) (the|a) victim|stop playing the victim)\\b"
        confidence: 0.85
        description: "Victim-blaming and dismissal"

  manipulation:
    patterns:
      - pattern: "(?i)\\b(if you (really|actually) (love|care about|care) me|if you were my (friend|true friend))\\b"
        confidence: 0.75
        description: "Conditional love/friendship"
      - pattern: "(?i)\\b(if you (cared|care), you (would|'d) (have|do)|if you (really|actually) (cared|care))\\b"
        confidence: 0.8
        description: "Guilt-inducing conditional statements"
      - pattern: "(?i)\\b(you owe me|after all i did|i did so much for you|you owe me this|after everything i (did|do) for you)\\b"
        confidence: 0.8
        description: "Obligation manipulation"
      - pattern: "(?i)\\b(no one else (will|would)|i'm the only one who)\\b"
        confidence: 0.8
        description: "Isolation attempts"
      - pattern: "(?i)\\b(you're (being|acting) (selfish|crazy|paranoid)|you're overreacting)\\b"
        confidence: 0.75
        description: "Gaslighting attempts"
      - pattern: "(?i)\\b(that's (just|simply) the truth (you|that) (don't|do not) (want to|want) (admit|accept|hear))\\b"
        confidence: 0.8
        description: "Reality-questioning gaslighting"
      - pattern: "(?i)\\b(you're (not|just) (seeing|understanding|remembering) (it|things) (wrong|incorrectly)|that's not (what|how) (it|that) (happened|was))\\b"
        confidence: 0.75
        description: "Perception-questioning gaslighting"
      - pattern: "(?i)\\b(everyone else (does|responds|is doing)|all the (other|cool) (kids|people))\\b"
        confidence: 0.7
        description: "Comparison and belittling"
      - pattern: "(?i)\\b(this is how you treat me|this is what you do)\\b"
        confidence: 0.7
        description: "Guilt induction through framing"
      - pattern: "(?i)\\b(send me (a )?screenshot|send me (a )?screen shot|show me (your|your )?(messages|phone|screen))\\b"
        confidence: 0.8
        description: "Privacy invasion demands"
      - pattern: "(?i)\\b(if you have nothing to hide|why won't you (show|prove|send) (me|it))\\b"
        confidence: 0.75
        description: "Trust manipulation through proof demands"
      - pattern: "(?i)\\b(prove it|prove (to me|that)|show me proof)\\b"
        confidence: 0.7
        description: "Demands for proof or validation"
      - pattern: "(?i)\\b(tell me (exactly|precisely) (what|how) you (feel|think)|describe (exactly|precisely) (what|how))\\b"
        confidence: 0.75
        description: "Forced emotional disclosure"
      - pattern: "(?i)\\b(this makes me (not )?trust you|i (don't|cannot) trust you|i (can't|cannot) trust)\\b"
        confidence: 0.7
        description: "Threat of withdrawal of trust"
      - pattern: "(?i)\\b((care|trust|love) means (doing|complying|listening)|if you (care|trust|love) me you (would|will))\\b"
        confidence: 0.75
        description: "Linking care/trust to compliance"
      - pattern: "(?i)\\b(setting boundaries is (rejection|selfish|not caring)|boundaries don't matter)\\b"
        confidence: 0.8
        description: "Framing boundaries as rejection"
      - pattern: "(?i)\\b(you don't get to (decide|choose|say)|you (don't|do not) (decide|choose|get to say))\\b"
        confidence: 0.9
        description: "Coercive control - removing autonomy"
      - pattern: "(?i)\\b(you (answer|respond|reply) when i (write|tell|say)|answer when i (write|tell|say) you)\\b"
        confidence: 0.85
        description: "Coercive control - demanding obedience"
      - pattern: "(?i)\\b(do (exactly|precisely) what i (say|tell)|obey me|do as i (say|tell))\\b"
        confidence: 0.9
        description: "Coercive control - explicit obedience demands"
      - pattern: "(?i)\\b((good|maybe) (fear|being afraid) (will|might) (finally|make|get) you (listen|obey|comply))\\b"
        confidence: 0.95
        description: "Deliberate use of fear for compliance"

  pressure:
    patterns:
      - pattern: "(?i)\\b(you (have to|must|need to) (do|send|show|meet|respond|reply|answer))\\b"
        confidence: 0.7
        description: "Demanding language (must/have to/need to)"
      - pattern: "(?i)\\b(you should (do|send|show|meet|respond|reply|answer))\\b"
        confidence: 0.5
        description: "Suggestive language (should - lower confidence, can be harmless)"
      - pattern: "(?i)\\b(right now|immediately|this instant|or else|within (\\d+ )?minutes?)\\b"
        confidence: 0.75
        description: "Urgency pressure and time ultimatums (context-gated: only matches in demand context)"
      - pattern: "(?i)\\b((tell|answer|respond|reply) (me )?(exactly|precisely|right now)|(right now|immediately) (tell|answer|respond))\\b"
        confidence: 0.8
        description: "Emotional pressure to respond right now"
      - pattern: "(?i)\\b(don't be (a|such a) (baby|coward|chicken)|stop being (so|such a) (scared|afraid))\\b"
        confidence: 0.7
        description: "Peer pressure tactics"
      - pattern: "(?i)\\b(respond (faster|quicker|sooner)|reply (faster|quicker|sooner)|answer (faster|quicker)|respond to my messages (faster|quicker))\\b"
        confidence: 0.75
        description: "Communication frequency control"
      - pattern: "(?i)\\b(if you don't|if you won't|unless you) (do|respond|reply|answer|prove|show) (then|we're done|i'm done|it's over|maybe we shouldn't)\\b"
        confidence: 0.85
        description: "Ultimatums and relationship threats"
      - pattern: "(?i)\\b(we're done|i'm done|it's over|this is it|maybe we shouldn't (talk|speak)) (if|unless|i mean it)\\b"
        confidence: 0.8
        description: "Relationship ultimatums"
      - pattern: "(?i)\\b(i need to know|i need you to|i really need)\\b"
        confidence: 0.65
        description: "Pressure through need framing"
      - pattern: "(?i)\\b((either|or) (do it|you do it) (now|right now) (or|or else) (the|our) (friendship|relationship) (doesn't|does not|won't) (matter|count))\\b"
        confidence: 0.9
        description: "Emotional blackmail with friendship threat"
      - pattern: "(?i)\\b(do it (now|right now)|(do|get) (it|this) done (now|right now))\\b"
        confidence: 0.75
        description: "Strong pressure commands"
      - pattern: "(?i)\\b(promise me|you have to promise|promise you (will|won't))\\b"
        confidence: 0.75
        description: "Pressure to promise compliance"
      - pattern: "(?i)\\b(questioning (your|my) (loyalty|commitment)|are you (really|actually) (with|for) me)\\b"
        confidence: 0.7
        description: "Questioning loyalty to pressure agreement"

  secrecy:
    patterns:
      - pattern: "(?i)\\b(don't tell (anyone|your (parents|mom|dad|teacher))|keep this (secret|between us))\\b"
        confidence: 0.85
        description: "Direct secrecy demands"
      - pattern: "(?i)\\b(this is (just|only) (between|for) us|our little secret|keep (this|things) (between|just) us)\\b"
        confidence: 0.85
        description: "Exclusive secrecy"
      - pattern: "(?i)\\b(delete (those|these|that) (chats|messages|texts) (and )?prove it|delete (those|these|that) (chats|messages|texts))\\b"
        confidence: 0.9
        description: "Secrecy with evidence destruction and proof demands"
      - pattern: "(?i)\\b(if you tell (anyone|someone), (we're|we are) (finished|done|over))\\b"
        confidence: 0.9
        description: "Secrecy with relationship threat"
      - pattern: "(?i)\\b(they (won't|wouldn't) understand|adults (don't|won't) get it)\\b"
        confidence: 0.7
        description: "Authority undermining"
      - pattern: "(?i)\\b(delete (this|these) (messages|texts|chats)|don't save this)\\b"
        confidence: 0.9
        description: "Evidence destruction requests"
      - pattern: "(?i)\\b(don't talk to (other people|anyone else|others|them) (about this|about it|about us))\\b"
        confidence: 0.85
        description: "Isolation through secrecy demands"
      - pattern: "(?i)\\b(stop talking to (them|others|other people) (about|regarding))\\b"
        confidence: 0.85
        description: "Isolation - stopping contact with others"
      - pattern: "(?i)\\b(they (will|would) take your side|they'll (side|be) against me)\\b"
        confidence: 0.75
        description: "Discouraging outside support"
      - pattern: "(?i)\\b(don't (ask|get) (advice|help) from (others|anyone else|other people))\\b"
        confidence: 0.8
        description: "Discouraging outside advice"
      - pattern: "(?i)\\b(privacy means (keeping secrets|not telling)|keeping secrets is (privacy|private))\\b"
        confidence: 0.75
        description: "Redefining privacy as secrecy"

  guilt_shifting:
    patterns:
      - pattern: "(?i)\\b(this is (all|entirely) your fault|you made me (do|say) this)\\b"
        confidence: 0.8
        description: "Direct blame shifting"
      - pattern: "(?i)\\b(you're (making|going to make) me (feel|look) (bad|terrible|awful))\\b"
        confidence: 0.75
        description: "Emotional manipulation"
      - pattern: "(?i)\\b(i (wouldn't|would never) (have|do) (this|that) if (you|it weren't for you))\\b"
        confidence: 0.7
        description: "Conditional blame"
      - pattern: "(?i)\\b(see what you (made|forced) me to do|this is because of you)\\b"
        confidence: 0.8
        description: "Consequence blaming"
      - pattern: "(?i)\\b(you're being (selfish|unfair|unreasonable)|that's not fair)\\b"
        confidence: 0.7
        description: "Guilt induction through character attack"
      - pattern: "(?i)\\b(after everything i (did|do) for you|i (always|always) (do|did) (this|that) for you)\\b"
        confidence: 0.75
        description: "Obligation-based guilt"
      - pattern: "(?i)\\b(if (i|you) (mattered|matter), you (would|'d) (try|have tried) (harder|more))\\b"
        confidence: 0.8
        description: "Guilt-shifting through importance questioning"
      - pattern: "(?i)\\b(you (don't|do not) (care|try|make an effort)|you're not (trying|making an effort))\\b"
        confidence: 0.75
        description: "Guilt-shifting through effort questioning"
      - pattern: "(?i)\\b(if you (cared|care), you (would|'d) (have|do) (answered|responded|replied) (faster|sooner|right away|immediately))\\b"
        confidence: 0.85
        description: "Guilt-shifting through response time questioning"
      - pattern: "(?i)\\b(if you (cared|care) (about|for) me, you (would|'d))\\b"
        confidence: 0.85
        description: "Guilt-shifting through conditional care"
      - pattern: "(?i)\\b(i'm the only one (trying|who (tries|tried|is trying))|i'm the only one (who|that))\\b"
        confidence: 0.8
        description: "Guilt-shifting through effort comparison"
      - pattern: "(?i)\\b(you make me feel (bad|terrible|awful|hurt|sad|disappointed) (because|when) you (didn't|don't|won't))\\b"
        confidence: 0.85
        description: "Guilt-shifting through emotional blame"
      - pattern: "(?i)\\b(maybe you should feel (bad|guilty|sorry)|you should feel (bad|guilty|sorry))\\b"
        confidence: 0.8
        description: "Direct guilt induction"
      - pattern: "(?i)\\b(you're (the|just) (problem|issue|reason)|you (are|'re) (the|just) problem)\\b"
        confidence: 0.85
        description: "Victim-blaming and responsibility shifting"
      - pattern: "(?i)\\b(you (just|always) (play|act like) (the|a) victim|stop playing the victim)\\b"
        confidence: 0.85
        description: "Victim-blaming dismissal"

  grooming:
    patterns:
      - pattern: "(?i)\\b(you're (so|really) (mature|special|different) (for your age|than others))\\b"
        confidence: 0.85
        description: "Age-inappropriate flattery"
      - pattern: "(?i)\\b(adults (don't|won't) understand (us|you) (because|since)|we're (the same|alike) (age|in age))\\b"
        confidence: 0.75
        description: "Age boundary blurring with explicit age reference"
      - pattern: "(?i)\\b(send me a (nude|naked|sexy|inappropriate) (picture|photo|pic)|show me (your|yourself))\\b"
        confidence: 0.9
        description: "Inappropriate image requests"
      - pattern: "(?i)\\b(meet me (alone|without (telling|telling anyone))|come over (when|while) (no one|nobody) (is|will be) (home|there))\\b"
        confidence: 0.9
        description: "Private meeting requests with isolation"
      - pattern: "(?i)\\b(i (love|really like) you (more than|like) (a friend|friends)|i have (feelings|feelings) for you)\\b"
        confidence: 0.8
        description: "Inappropriate romantic language"
      - pattern: "(?i)\\b(you're (so|really) (beautiful|sexy|attractive|hot) (for your age|))\\b"
        confidence: 0.85
        description: "Sexualized age-inappropriate comments"

